<!DOCTYPE html><html lang="en-US"><head><title>Data Workshop</title><meta property="og:title" content="Data Workshop"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"><meta name="apple-mobile-web-app-capable" content="yes"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><style>.bespoke-marp-note,.bespoke-marp-osc,.bespoke-progress-parent{display:none;transition:none}@media screen{body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;font-size:inherit;opacity:.8;outline:none;padding:0;transition:opacity .2s linear;-webkit-tap-highlight-color:transparent}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:disabled,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:disabled{cursor:not-allowed;opacity:.15!important}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover{opacity:1}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:active,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:active{opacity:.6}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button:hover:not(:disabled),body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button:hover:not(:disabled){transition:none}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-prev{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNNjggOTBMMjggNTBsNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button.bespoke-marp-presenter-info-page-next{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNmZmYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSI1IiBkPSJNMzIgOTBsNDAtNDAtNDAtNDAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTQwIDcwSDIwVjUwbTIwIDBMMjAgNzBtNDAtNDBoMjB2MjBtLTIwIDBsMjAtMjAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button.exit[data-bespoke-marp-osc=fullscreen]{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6NXB4fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJhIiB4PSIxMCIgeT0iMjAiIHdpZHRoPSI4MCIgaGVpZ2h0PSI2MCIgcng9IjUuNjciLz48cGF0aCBjbGFzcz0iYSIgZD0iTTIwIDUwaDIwdjIwbS0yMCAwbDIwLTIwbTQwIDBINjBWMzBtMjAgMEw2MCA1MCIvPjwvc3ZnPg==")}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter]{background:transparent url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIj48ZGVmcz48c3R5bGU+LmF7ZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS13aWR0aDo1cHh9PC9zdHlsZT48L2RlZnM+PHBhdGggY2xhc3M9ImEiIGQ9Ik0yMCA2MGgtNWE1IDUgMCAwMS01LTVWMjBhNSA1IDAgMDE1LTVoNjBhNSA1IDAgMDE1IDV2NU0zMCA4NWg2MCIvPjxyZWN0IHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmZmIi8+PHJlY3QgY2xhc3M9ImEiIHg9IjMwIiB5PSIzNSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjQwIiByeD0iNSIvPjxwYXRoIGNsYXNzPSJhIiBkPSJNNDAgNTBoNDBNNDAgNjBoMzAiLz48L3N2Zz4=") no-repeat 50%;background-size:contain;overflow:hidden;text-indent:100%;white-space:nowrap}body,html{height:100%;margin:0}body{background:#000;overflow:hidden}svg.bespoke-marp-slide{opacity:0;pointer-events:none;z-index:-1}svg.bespoke-marp-slide.bespoke-marp-active{opacity:1;pointer-events:auto;z-index:0}svg.bespoke-marp-slide.bespoke-marp-active.bespoke-marp-active-ready *{-webkit-animation-name:__bespoke_marp__!important;animation-name:__bespoke_marp__!important}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable]{display:none}svg.bespoke-marp-slide[data-bespoke-marp-load=hideable].bespoke-marp-active{display:block}[data-bespoke-marp-fragment=inactive]{visibility:hidden}body[data-bespoke-view=""] .bespoke-marp-parent,body[data-bespoke-view=next] .bespoke-marp-parent{bottom:0;left:0;position:absolute;right:0;top:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc{background:rgba(0,0,0,.65);border-radius:7px;bottom:50px;color:#fff;display:block;font-family:Helvetica,Arial,sans-serif;font-size:16px;left:50%;line-height:0;opacity:1;padding:12px;position:absolute;touch-action:manipulation;transform:translateX(-50%);transition:opacity .2s linear;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;z-index:1;will-change:transform}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>*,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>*{margin-left:6px}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>:first-child,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>:first-child{margin-left:0}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span,body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span{opacity:.8}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>span[data-bespoke-marp-osc=page]{display:inline-block;min-width:140px;text-align:center}body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=""] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=fullscreen],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=next],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=presenter],body[data-bespoke-view=next] .bespoke-marp-parent>.bespoke-marp-osc>button[data-bespoke-marp-osc=prev]{height:32px;line-height:32px;width:32px}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive{cursor:none}body[data-bespoke-view=""] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc,body[data-bespoke-view=next] .bespoke-marp-parent.bespoke-marp-inactive>.bespoke-marp-osc{opacity:0;pointer-events:none}body[data-bespoke-view=""] svg.bespoke-marp-slide,body[data-bespoke-view=next] svg.bespoke-marp-slide{height:100%;left:0;position:absolute;top:0;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent{background:#222;display:flex;height:5px;width:100%}body[data-bespoke-view=""] .bespoke-progress-parent+.bespoke-marp-parent{top:5px}body[data-bespoke-view=""] .bespoke-progress-parent .bespoke-progress-bar{flex:0 0 0;background:#0288d1;transition:flex-basis .2s cubic-bezier(0,1,1,1)}body[data-bespoke-view=next]{background:transparent}body[data-bespoke-view=presenter]{background:#161616}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container{height:100%;left:0;position:absolute;top:0;width:100%;display:grid;grid-template-columns:2fr 1fr;grid-template-rows:minmax(140px,1fr) 2fr 3em;grid-template-areas:"current next" "current note" "info    note"}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent{grid-area:current;position:relative;overflow:hidden}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide{height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;top:20px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-parent svg.bespoke-marp-slide.bespoke-marp-active{-webkit-filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));filter:drop-shadow(0 3px 10px rgba(0,0,0,.5))}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container{background:#222;cursor:pointer;display:none;grid-area:next;overflow:hidden;position:relative}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-next-container iframe.bespoke-marp-presenter-next{background:transparent;border:0;display:block;-webkit-filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));filter:drop-shadow(0 3px 10px rgba(0,0,0,.5));height:calc(100% - 40px);left:20px;position:absolute;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;top:20px;width:calc(100% - 40px)}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container{background:#222;color:#ddd;grid-area:note}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note{margin:20px;width:calc(100% - 40px);height:calc(100% - 40px);box-sizing:border-box;overflow:auto;padding-right:3px;white-space:pre-wrap;word-wrap:break-word;scrollbar-width:thin;scrollbar-color:hsla(0,0%,86.7%,.5) transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar{width:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-track{background:transparent}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note::-webkit-scrollbar-thumb{background:hsla(0,0%,86.7%,.5);border-radius:6px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note:empty{pointer-events:none}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note.active{display:block}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:first-child{margin-top:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-note-container .bespoke-marp-note p:last-child{margin-bottom:0}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container{align-items:center;box-sizing:border-box;color:#ddd;display:flex;flex-wrap:nowrap;grid-area:info;justify-content:center;padding:0 10px}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time,body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{display:block;box-sizing:border-box;padding:0 10px;white-space:nowrap;width:100%}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container button{height:1.5em;line-height:1.5em;width:1.5em}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page{order:2;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-page .bespoke-marp-presenter-info-page-text{display:inline-block;min-width:120px;text-align:center}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-time{color:#999;order:1;text-align:left}body[data-bespoke-view=presenter] .bespoke-marp-presenter-container .bespoke-marp-presenter-info-container .bespoke-marp-presenter-info-timer{color:#999;order:3;text-align:right}}@media print{.bespoke-marp-presenter-info-container,.bespoke-marp-presenter-next-container,.bespoke-marp-presenter-note-container{display:none}}</style><style>div#p>svg>foreignObject>section{width:1280px;height:720px;box-sizing:border-box;overflow:hidden;position:relative;scroll-snap-align:center center}div#p>svg>foreignObject>section:after{bottom:0;content:attr(data-marpit-pagination);padding:inherit;pointer-events:none;position:absolute;right:0}div#p>svg>foreignObject>section:not([data-marpit-pagination]):after{display:none}/* Normalization */div#p>svg>foreignObject>section h1{font-size:2em;margin:0.67em 0}div#p>svg>foreignObject>section video::-webkit-media-controls{will-change:transform}@page{size:1280px 720px;margin:0}@media print{body,html{background-color:#fff;margin:0;page-break-inside:avoid;break-inside:avoid-page}div#p>svg>foreignObject>section{page-break-before:always;break-before:page}div#p>svg>foreignObject>section,div#p>svg>foreignObject>section *{-webkit-print-color-adjust:exact!important;animation-delay:0s!important;animation-duration:0s!important;color-adjust:exact!important;transition:none!important}div#p>svg[data-marpit-svg]{display:block;height:100vh;width:100vw}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{display:block;height:auto;width:100%}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{position:static}}div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{content:""}@supports (-ms-ime-align:auto){div#p>svg>foreignObject>section svg[data-marp-fitting=svg].__reflow__{position:relative}}div#p>svg>foreignObject>section [data-marp-fitting-svg-content]{display:table;white-space:nowrap}div#p>svg>foreignObject>section [data-marp-fitting-svg-content-wrap]{white-space:pre}div#p>svg>foreignObject>section img[data-marp-twemoji]{background:transparent;height:1em;margin:0 .05em 0 .1em;vertical-align:-.1em;width:1em}
/*!
 * Marp default theme.
 *
 * @theme default
 * @author Yuki Hattori
 *
 * @auto-scaling true
 * @size 4:3 960px 720px
 */div#p>svg>foreignObject>section .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}div#p>svg>foreignObject>section .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}div#p>svg>foreignObject>section .anchor:focus{outline:none}div#p>svg>foreignObject>section h1 .octicon-link,div#p>svg>foreignObject>section h2 .octicon-link,div#p>svg>foreignObject>section h3 .octicon-link,div#p>svg>foreignObject>section h4 .octicon-link,div#p>svg>foreignObject>section h5 .octicon-link,div#p>svg>foreignObject>section h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}div#p>svg>foreignObject>section h1:hover .anchor,div#p>svg>foreignObject>section h2:hover .anchor,div#p>svg>foreignObject>section h3:hover .anchor,div#p>svg>foreignObject>section h4:hover .anchor,div#p>svg>foreignObject>section h5:hover .anchor,div#p>svg>foreignObject>section h6:hover .anchor{text-decoration:none}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link{visibility:visible}div#p>svg>foreignObject>section h1:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h2:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h3:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h4:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h5:hover .anchor .octicon-link:before,div#p>svg>foreignObject>section h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}div#p>svg>foreignObject>section{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}div#p>svg>foreignObject>section{--marpit-root-font-size:16px}div#p>svg>foreignObject>section details{display:block}div#p>svg>foreignObject>section summary{display:list-item}div#p>svg>foreignObject>section a{background-color:initial}div#p>svg>foreignObject>section a:active,div#p>svg>foreignObject>section a:hover{outline-width:0}div#p>svg>foreignObject>section strong{font-weight:inherit;font-weight:bolder}div#p>svg>foreignObject>section h1{margin:.67em 0}div#p>svg>foreignObject>section img{border-style:none}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section kbd,div#p>svg>foreignObject>section pre{font-family:monospace,monospace;font-size:1em}div#p>svg>foreignObject>section hr{box-sizing:initial;overflow:visible}div#p>svg>foreignObject>section input{font:inherit;margin:0;overflow:visible}div#p>svg>foreignObject>section [type=checkbox]{padding:0}div#p>svg>foreignObject>section *,div#p>svg>foreignObject>section [type=checkbox]{box-sizing:border-box}div#p>svg>foreignObject>section input{font-family:inherit;font-size:inherit;line-height:inherit}div#p>svg>foreignObject>section a{color:#0366d6;text-decoration:none}div#p>svg>foreignObject>section a:hover{text-decoration:underline}div#p>svg>foreignObject>section strong{font-weight:600}div#p>svg>foreignObject>section hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}div#p>svg>foreignObject>section hr:after,div#p>svg>foreignObject>section hr:before{display:table;content:""}div#p>svg>foreignObject>section hr:after{clear:both}div#p>svg>foreignObject>section table{border-spacing:0;border-collapse:collapse}div#p>svg>foreignObject>section td,div#p>svg>foreignObject>section th{padding:0}div#p>svg>foreignObject>section details summary{cursor:pointer}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section h1{font-size:32px}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{font-weight:600}div#p>svg>foreignObject>section h2{font-size:24px}div#p>svg>foreignObject>section h3{font-size:20px}div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4{font-weight:600}div#p>svg>foreignObject>section h4{font-size:16px}div#p>svg>foreignObject>section h5{font-size:14px}div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{font-weight:600}div#p>svg>foreignObject>section h6{font-size:12px}div#p>svg>foreignObject>section p{margin-top:0;margin-bottom:10px}div#p>svg>foreignObject>section blockquote{margin:0}div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section ul{padding-left:0;margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ul ol{list-style-type:lower-roman}div#p>svg>foreignObject>section ol ol ol,div#p>svg>foreignObject>section ol ul ol,div#p>svg>foreignObject>section ul ol ol,div#p>svg>foreignObject>section ul ul ol{list-style-type:lower-alpha}div#p>svg>foreignObject>section dd{margin-left:0}div#p>svg>foreignObject>section code,div#p>svg>foreignObject>section pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}div#p>svg>foreignObject>section pre{margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section input::-webkit-inner-spin-button,div#p>svg>foreignObject>section input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}div#p>svg>foreignObject>section :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}div#p>svg>foreignObject>section .border{border:1px solid #e1e4e8!important}div#p>svg>foreignObject>section .border-0{border:0!important}div#p>svg>foreignObject>section .border-bottom{border-bottom:1px solid #e1e4e8!important}div#p>svg>foreignObject>section .rounded-1{border-radius:3px!important}div#p>svg>foreignObject>section .bg-white{background-color:#fff!important}div#p>svg>foreignObject>section .bg-gray-light{background-color:#fafbfc!important}div#p>svg>foreignObject>section .text-gray-light{color:#6a737d!important}div#p>svg>foreignObject>section .pl-3,div#p>svg>foreignObject>section .px-3{padding-left:16px!important}div#p>svg>foreignObject>section .px-3{padding-right:16px!important}div#p>svg>foreignObject>section .f6{font-size:12px!important}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.f6{--marpit-root-font-size:12px!important}div#p>svg>foreignObject>section .lh-condensed{line-height:1.25!important}div#p>svg>foreignObject>section .text-bold{font-weight:600!important}div#p>svg>foreignObject>section .pl-c{color:#6a737d}div#p>svg>foreignObject>section .pl-c1,div#p>svg>foreignObject>section .pl-s .pl-v{color:#005cc5}div#p>svg>foreignObject>section .pl-e,div#p>svg>foreignObject>section .pl-en{color:#6f42c1}div#p>svg>foreignObject>section .pl-s .pl-s1,div#p>svg>foreignObject>section .pl-smi{color:#24292e}div#p>svg>foreignObject>section .pl-ent{color:#22863a}div#p>svg>foreignObject>section .pl-k{color:#d73a49}div#p>svg>foreignObject>section .pl-pds,div#p>svg>foreignObject>section .pl-s,div#p>svg>foreignObject>section .pl-s .pl-pse .pl-s1,div#p>svg>foreignObject>section .pl-sr,div#p>svg>foreignObject>section .pl-sr .pl-cce,div#p>svg>foreignObject>section .pl-sr .pl-sra,div#p>svg>foreignObject>section .pl-sr .pl-sre{color:#032f62}div#p>svg>foreignObject>section .pl-smw,div#p>svg>foreignObject>section .pl-v{color:#e36209}div#p>svg>foreignObject>section .pl-bu{color:#b31d28}div#p>svg>foreignObject>section .pl-ii{color:#fafbfc;background-color:#b31d28}div#p>svg>foreignObject>section .pl-c2{color:#fafbfc;background-color:#d73a49}div#p>svg>foreignObject>section .pl-c2:before{content:"^M"}div#p>svg>foreignObject>section .pl-sr .pl-cce{font-weight:700;color:#22863a}div#p>svg>foreignObject>section .pl-ml{color:#735c0f}div#p>svg>foreignObject>section .pl-mh,div#p>svg>foreignObject>section .pl-mh .pl-en,div#p>svg>foreignObject>section .pl-ms{font-weight:700;color:#005cc5}div#p>svg>foreignObject>section .pl-mi{font-style:italic;color:#24292e}div#p>svg>foreignObject>section .pl-mb{font-weight:700;color:#24292e}div#p>svg>foreignObject>section .pl-md{color:#b31d28;background-color:#ffeef0}div#p>svg>foreignObject>section .pl-mi1{color:#22863a;background-color:#f0fff4}div#p>svg>foreignObject>section .pl-mc{color:#e36209;background-color:#ffebda}div#p>svg>foreignObject>section .pl-mi2{color:#f6f8fa;background-color:#005cc5}div#p>svg>foreignObject>section .pl-mdr{font-weight:700;color:#6f42c1}div#p>svg>foreignObject>section .pl-ba{color:#586069}div#p>svg>foreignObject>section .pl-sg{color:#959da5}div#p>svg>foreignObject>section .pl-corl{text-decoration:underline;color:#032f62}div#p>svg>foreignObject>section .mb-0{margin-bottom:0!important}div#p>svg>foreignObject>section .my-2{margin-bottom:8px!important;margin-top:8px!important}div#p>svg>foreignObject>section .pl-0{padding-left:0!important}div#p>svg>foreignObject>section .py-0{padding-top:0!important;padding-bottom:0!important}div#p>svg>foreignObject>section .pl-1{padding-left:4px!important}div#p>svg>foreignObject>section .pl-2{padding-left:8px!important}div#p>svg>foreignObject>section .py-2{padding-top:8px!important;padding-bottom:8px!important}div#p>svg>foreignObject>section .pl-3{padding-left:16px!important}div#p>svg>foreignObject>section .pl-4{padding-left:24px!important}div#p>svg>foreignObject>section .pl-5{padding-left:32px!important}div#p>svg>foreignObject>section .pl-6{padding-left:40px!important}div#p>svg>foreignObject>section .pl-7{padding-left:48px!important}div#p>svg>foreignObject>section .pl-8{padding-left:64px!important}div#p>svg>foreignObject>section .pl-9{padding-left:80px!important}div#p>svg>foreignObject>section .pl-10{padding-left:96px!important}div#p>svg>foreignObject>section .pl-11{padding-left:112px!important}div#p>svg>foreignObject>section .pl-12{padding-left:128px!important}div#p>svg>foreignObject>section hr{border-bottom-color:#eee}div#p>svg>foreignObject>section kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}div#p>svg>foreignObject>section:after,div#p>svg>foreignObject>section:before{display:table
  /* content:""; */}div#p>svg>foreignObject>section:after{clear:both}div#p>svg>foreignObject>section>:first-child{margin-top:0!important}div#p>svg>foreignObject>section>:last-child{margin-bottom:0!important}div#p>svg>foreignObject>section a:not([href]){color:inherit;text-decoration:none}div#p>svg>foreignObject>section blockquote,div#p>svg>foreignObject>section details,div#p>svg>foreignObject>section dl,div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section p,div#p>svg>foreignObject>section pre,div#p>svg>foreignObject>section table,div#p>svg>foreignObject>section ul{margin-top:0;margin-bottom:16px}div#p>svg>foreignObject>section hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}div#p>svg>foreignObject>section blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}div#p>svg>foreignObject>section blockquote>:first-child{margin-top:0}div#p>svg>foreignObject>section blockquote>:last-child{margin-bottom:0}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2,div#p>svg>foreignObject>section h3,div#p>svg>foreignObject>section h4,div#p>svg>foreignObject>section h5,div#p>svg>foreignObject>section h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}div#p>svg>foreignObject>section h1{font-size:2em}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}div#p>svg>foreignObject>section h2{font-size:1.5em}div#p>svg>foreignObject>section h3{font-size:1.25em}div#p>svg>foreignObject>section h4{font-size:1em}div#p>svg>foreignObject>section h5{font-size:.875em}div#p>svg>foreignObject>section h6{font-size:.85em;color:#6a737d}div#p>svg>foreignObject>section ol,div#p>svg>foreignObject>section ul{padding-left:2em}div#p>svg>foreignObject>section ol ol,div#p>svg>foreignObject>section ol ul,div#p>svg>foreignObject>section ul ol,div#p>svg>foreignObject>section ul ul{margin-top:0;margin-bottom:0}div#p>svg>foreignObject>section li{word-wrap:break-all}div#p>svg>foreignObject>section li>p{margin-top:16px}div#p>svg>foreignObject>section li+li{margin-top:.25em}div#p>svg>foreignObject>section dl{padding:0}div#p>svg>foreignObject>section dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}div#p>svg>foreignObject>section dl dd{padding:0 16px;margin-bottom:16px}div#p>svg>foreignObject>section table{display:block;width:100%;overflow:auto}div#p>svg>foreignObject>section table th{font-weight:600}div#p>svg>foreignObject>section table td,div#p>svg>foreignObject>section table th{padding:6px 13px;border:1px solid #dfe2e5}div#p>svg>foreignObject>section table tr{background-color:#fff;border-top:1px solid #c6cbd1}div#p>svg>foreignObject>section table tr:nth-child(2n){background-color:#f6f8fa}div#p>svg>foreignObject>section img{max-width:100%;box-sizing:initial;background-color:#fff}div#p>svg>foreignObject>section img[align=right]{padding-left:20px}div#p>svg>foreignObject>section img[align=left]{padding-right:20px}div#p>svg>foreignObject>section code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}div#p>svg>foreignObject>section pre{word-wrap:normal}div#p>svg>foreignObject>section pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}div#p>svg>foreignObject>section .highlight{margin-bottom:16px}div#p>svg>foreignObject>section .highlight pre{margin-bottom:0;word-break:normal}div#p>svg>foreignObject>section pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}div#p>svg>foreignObject>section pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}div#p>svg>foreignObject>section .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.commit-tease-sha{--marpit-root-font-size:90%}div#p>svg>foreignObject>section .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}div#p>svg>foreignObject>section .blob-wrapper{overflow-x:auto;overflow-y:hidden}div#p>svg>foreignObject>section .blob-wrapper-embedded{max-height:240px;overflow-y:auto}div#p>svg>foreignObject>section .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.blob-num{--marpit-root-font-size:12px}div#p>svg>foreignObject>section .blob-num:hover{color:rgba(27,31,35,.6)}div#p>svg>foreignObject>section .blob-num:before{content:attr(data-line-number)}div#p>svg>foreignObject>section .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}div#p>svg>foreignObject>section .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}div#p>svg>foreignObject>section div#p>svg>foreignObject>section section.blob-code-inner{--marpit-root-font-size:12px}div#p>svg>foreignObject>section .pl-token.active,div#p>svg>foreignObject>section .pl-token:hover{cursor:pointer;background:#ffea7f}div#p>svg>foreignObject>section .tab-size[data-tab-size="1"]{-moz-tab-size:1;-o-tab-size:1;tab-size:1}div#p>svg>foreignObject>section .tab-size[data-tab-size="2"]{-moz-tab-size:2;-o-tab-size:2;tab-size:2}div#p>svg>foreignObject>section .tab-size[data-tab-size="3"]{-moz-tab-size:3;-o-tab-size:3;tab-size:3}div#p>svg>foreignObject>section .tab-size[data-tab-size="4"]{-moz-tab-size:4;-o-tab-size:4;tab-size:4}div#p>svg>foreignObject>section .tab-size[data-tab-size="5"]{-moz-tab-size:5;-o-tab-size:5;tab-size:5}div#p>svg>foreignObject>section .tab-size[data-tab-size="6"]{-moz-tab-size:6;-o-tab-size:6;tab-size:6}div#p>svg>foreignObject>section .tab-size[data-tab-size="7"]{-moz-tab-size:7;-o-tab-size:7;tab-size:7}div#p>svg>foreignObject>section .tab-size[data-tab-size="8"]{-moz-tab-size:8;-o-tab-size:8;tab-size:8}div#p>svg>foreignObject>section .tab-size[data-tab-size="9"]{-moz-tab-size:9;-o-tab-size:9;tab-size:9}div#p>svg>foreignObject>section .tab-size[data-tab-size="10"]{-moz-tab-size:10;-o-tab-size:10;tab-size:10}div#p>svg>foreignObject>section .tab-size[data-tab-size="11"]{-moz-tab-size:11;-o-tab-size:11;tab-size:11}div#p>svg>foreignObject>section .tab-size[data-tab-size="12"]{-moz-tab-size:12;-o-tab-size:12;tab-size:12}div#p>svg>foreignObject>section .task-list-item{list-style-type:none}div#p>svg>foreignObject>section .task-list-item+.task-list-item{margin-top:3px}div#p>svg>foreignObject>section .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}div#p>svg>foreignObject>section .hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}div#p>svg>foreignObject>section .hljs-comment,div#p>svg>foreignObject>section .hljs-meta{color:#969896}div#p>svg>foreignObject>section .hljs-emphasis,div#p>svg>foreignObject>section .hljs-quote,div#p>svg>foreignObject>section .hljs-strong,div#p>svg>foreignObject>section .hljs-template-variable,div#p>svg>foreignObject>section .hljs-variable{color:#df5000}div#p>svg>foreignObject>section .hljs-keyword,div#p>svg>foreignObject>section .hljs-selector-tag,div#p>svg>foreignObject>section .hljs-type{color:#d73a49}div#p>svg>foreignObject>section .hljs-attribute,div#p>svg>foreignObject>section .hljs-bullet,div#p>svg>foreignObject>section .hljs-literal,div#p>svg>foreignObject>section .hljs-symbol{color:#0086b3}div#p>svg>foreignObject>section .hljs-name,div#p>svg>foreignObject>section .hljs-section{color:#63a35c}div#p>svg>foreignObject>section .hljs-tag{color:#333}div#p>svg>foreignObject>section .hljs-attr,div#p>svg>foreignObject>section .hljs-selector-attr,div#p>svg>foreignObject>section .hljs-selector-class,div#p>svg>foreignObject>section .hljs-selector-id,div#p>svg>foreignObject>section .hljs-selector-pseudo,div#p>svg>foreignObject>section .hljs-title{color:#6f42c1}div#p>svg>foreignObject>section .hljs-addition{color:#55a532;background-color:#eaffea}div#p>svg>foreignObject>section .hljs-deletion{color:#bd2c00;background-color:#ffecec}div#p>svg>foreignObject>section .hljs-link{text-decoration:underline}div#p>svg>foreignObject>section .hljs-number{color:#005cc5}div#p>svg>foreignObject>section .hljs-string{color:#032f62}div#p>svg>foreignObject>section svg[data-marp-fitting=svg]{max-height:563px}div#p>svg>foreignObject>section h1{color:#246;font-size:1.6em}div#p>svg>foreignObject>section h1,div#p>svg>foreignObject>section h2{border-bottom:none}div#p>svg>foreignObject>section h2{font-size:1.3em}div#p>svg>foreignObject>section h3{font-size:1.1em}div#p>svg>foreignObject>section h4{font-size:1.05em}div#p>svg>foreignObject>section h5{font-size:1em}div#p>svg>foreignObject>section h6{font-size:.9em}div#p>svg>foreignObject>section h1 strong,div#p>svg>foreignObject>section h2 strong,div#p>svg>foreignObject>section h3 strong,div#p>svg>foreignObject>section h4 strong,div#p>svg>foreignObject>section h5 strong,div#p>svg>foreignObject>section h6 strong{font-weight:inherit;color:#48c}div#p>svg>foreignObject>section hr{height:0;padding-top:.25em}div#p>svg>foreignObject>section pre{border:1px solid #999;line-height:1.15;overflow:visible}div#p>svg>foreignObject>section pre code svg[data-marp-fitting=svg]{max-height:529px}div#p>svg>foreignObject>section footer,div#p>svg>foreignObject>section header{margin:0;position:absolute;left:30px;color:hsla(0,0%,40%,.75);font-size:18px}div#p>svg>foreignObject>section header{top:21px}div#p>svg>foreignObject>section footer{bottom:21px}div#p>svg>foreignObject>section{align-items:stretch;background:#fff;display:flex;flex-direction:column;flex-wrap:nowrap;font-size:29px;height:720px;justify-content:center;padding:78.5px;width:1280px}div#p>svg>foreignObject>section{--marpit-root-font-size:29px}div#p>svg>foreignObject>section>:last-child,div#p>svg>foreignObject>section[data-footer]>:nth-last-child(2){margin-bottom:0}div#p>svg>foreignObject>section>:first-child,div#p>svg>foreignObject>section>header:first-child+*{margin-top:0}div#p>svg>foreignObject>section:after{position:absolute;padding:0;right:30px;bottom:21px;font-size:24px;color:#777}div#p>svg>foreignObject>section:after{--marpit-root-font-size:24px}div#p>svg>foreignObject>section.invert{background-color:#222;color:#e6eaf0}div#p>svg>foreignObject>section.invert:after{color:#999}div#p>svg>foreignObject>section.invert img{background-color:transparent}div#p>svg>foreignObject>section.invert a{color:#50b3ff}div#p>svg>foreignObject>section.invert h1{color:#a3c5e7}div#p>svg>foreignObject>section.invert h2,div#p>svg>foreignObject>section.invert h3,div#p>svg>foreignObject>section.invert h4,div#p>svg>foreignObject>section.invert h5{color:#ebeff5}div#p>svg>foreignObject>section.invert blockquote,div#p>svg>foreignObject>section.invert h6{border-color:#3d3f43;color:#939699}div#p>svg>foreignObject>section.invert h1 strong,div#p>svg>foreignObject>section.invert h2 strong,div#p>svg>foreignObject>section.invert h3 strong,div#p>svg>foreignObject>section.invert h4 strong,div#p>svg>foreignObject>section.invert h5 strong,div#p>svg>foreignObject>section.invert h6 strong{color:#7bf}div#p>svg>foreignObject>section.invert hr{background-color:#3d3f43}div#p>svg>foreignObject>section.invert footer,div#p>svg>foreignObject>section.invert header{color:hsla(0,0%,60%,.75)}div#p>svg>foreignObject>section.invert code,div#p>svg>foreignObject>section.invert kbd{background-color:#111}div#p>svg>foreignObject>section.invert kbd{border-color:#666;box-shadow:inset 0 -1px 0 #555;color:#e6eaf0}div#p>svg>foreignObject>section.invert table tr{background-color:#12181d;border-color:#60657b}div#p>svg>foreignObject>section.invert table tr:nth-child(2n){background-color:#1b2024}div#p>svg>foreignObject>section.invert table td,div#p>svg>foreignObject>section.invert table th{border-color:#5b5e61}div#p>svg>foreignObject>section.invert pre{background-color:#0a0e12;border-color:#777}div#p>svg>foreignObject>section.invert pre code{background-color:transparent}div#p>svg>foreignObject>section[data-color] h1,div#p>svg>foreignObject>section[data-color] h2,div#p>svg>foreignObject>section[data-color] h3,div#p>svg>foreignObject>section[data-color] h4,div#p>svg>foreignObject>section[data-color] h5,div#p>svg>foreignObject>section[data-color] h6{color:currentColor}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]{display:block!important;padding:0!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=background]:before,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:after,div#p>svg>foreignObject>section[data-marpit-advanced-background=content]:before{display:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]{all:initial;display:flex;flex-direction:row;height:100%;overflow:hidden;width:100%}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container][data-marpit-advanced-background-direction=vertical]{flex-direction:column}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split]>div[data-marpit-advanced-background-container]{width:var(--marpit-advanced-background-split,50%)}div#p>svg>foreignObject>section[data-marpit-advanced-background=background][data-marpit-advanced-background-split=right]>div[data-marpit-advanced-background-container]{margin-left:calc(100% - var(--marpit-advanced-background-split, 50%))}div#p>svg>foreignObject>section[data-marpit-advanced-background=background]>div[data-marpit-advanced-background-container]>figure{all:initial;background-position:center;background-repeat:no-repeat;background-size:cover;flex:auto;margin:0}div#p>svg>foreignObject>section[data-marpit-advanced-background=content],div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo]{background:transparent!important}div#p>svg>foreignObject>section[data-marpit-advanced-background=pseudo],div#p>svg[data-marpit-svg]>foreignObject[data-marpit-advanced-background=pseudo]{pointer-events:none!important}div#p>svg>foreignObject>section[data-marpit-advanced-background-split]{width:100%;height:100%}</style></head><body><div class="bespoke-marp-osc"><button data-bespoke-marp-osc="prev" tabindex="-1" title="Previous slide">Previous slide</button><span data-bespoke-marp-osc="page"></span><button data-bespoke-marp-osc="next" tabindex="-1" title="Next slide">Next slide</button><button data-bespoke-marp-osc="fullscreen" tabindex="-1" title="Toggle fullscreen (f)">Toggle fullscreen</button><button data-bespoke-marp-osc="presenter" tabindex="-1" title="Open presenter view (p)">Open presenter view</button></div><div id="p"><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="1" data-paginate="true" data-theme="default" data-marpit-pagination="1" data-marpit-pagination-total="37" style="--paginate:true;--theme:default;">
<h1>Geographic Data in Python</h1>
<p>A Mahfouz<br />
Toronto Data Workshop<br />
25 June 2020</p>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="2" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="2" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Agenda</h1>
<ul>
<li>About me</li>
<li>Project description</li>
<li>Google Directions API: APIs, time, build-your-own-geojson</li>
<li>OpenTripPlanner: more about spatial data representation, simple spatial operations</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="3" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="3" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>About Me</h1>
<ul>
<li>Master of Information student at the University of Toronto</li>
<li>Geographer by training</li>
<li>Still not used to writing about me sections</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="4" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="4" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Project Description</h1>
<ul>
<li>Transit analysis for schools in multiple cities in the US</li>
<li>What would their students' commutes look like?</li>
<li>What areas of the city are within reasonable commuting distance via transit?</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="5" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="5" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Toolset</h1>
<ul>
<li>Python</li>
<li>Google Directions API</li>
<li>OpenTripPlanner</li>
<li>QGIS</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="6" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="6" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Skills/Concepts</h1>
<ul>
<li>Working with APIs</li>
<li>UNIX time and timezones <img class="emoji" draggable="false" alt="😱" src="https://twemoji.maxcdn.com/2/svg/1f631.svg" data-marp-twemoji=""/></li>
<li>Build-your-own dataset</li>
<li>Spatial data representation</li>
<li>Common file formats</li>
<li>Basic spatial operations</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="7" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="7" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Inputs</h1>
<h3>School data</h3>
<table>
<thead>
<tr>
<th>School Name</th>
<th>School Address</th>
<th>AM Bell Time</th>
<th>PM Bell Time</th>
</tr>
</thead>
<tbody>
<tr>
<td>PS X</td>
<td>601 N Mesa</td>
<td>7:30 AM</td>
<td>2:30 PM</td>
</tr>
</tbody>
</table>
<h3>Student data</h3>
<table>
<thead>
<tr>
<th>ID</th>
<th>Grade</th>
<th>Address</th>
<th>Stop</th>
</tr>
</thead>
<tbody>
<tr>
<td>123456789</td>
<td>9</td>
<td>711 Hills</td>
<td>St Vrain &amp; E Father Rahm</td>
</tr>
</tbody>
</table>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="8" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="8" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>A Note on Geocoding</h1>
<ul>
<li>AKA converting addresses into coordinates</li>
<li>Unnecessary for the Directions API</li>
<li>Google's geocoder is pretty error-tolerant</li>
<li>Some other options: Nominatim, Mapbox, HERE</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="9" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="9" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Working with the Google Directions API</h1>
<ul>
<li>We'll just use <a href="https://requests.readthedocs.io/en/master/"><code>requests</code></a>
<ul>
<li>Versatile library for HTTP requests</li>
</ul>
</li>
<li>There is a Python client (<a href="https://github.com/googlemaps/google-maps-services-python"><code>googlemaps</code></a>) but it doesn't return the full API response</li>
<li>Request parameters
<ul>
<li>API key</li>
<li><code>origin</code></li>
<li><code>destination</code></li>
<li><code>mode</code></li>
<li><code>departure_time</code> or <code>arrival_time</code></li>
</ul>
</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="10" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="10" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Do the Time Warp</h1>
<ul>
<li>We have bell times as text (e.g., &quot;7:30 AM&quot;) but need UNIX timestamps (seconds since midnight 1/1/1970 UTC)</li>
<li>Specific travel dates aren't important, but constraints apply:
<ul>
<li>Must be a non-holiday weekday</li>
<li>Cannot be too far into the past or future</li>
</ul>
</li>
<li>Schools are in all different time zones</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="11" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="11" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Do the Time Warp</h1>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> date, datetime
<span class="hljs-keyword">from</span> dateutil <span class="hljs-keyword">import</span> parser, tz
<span class="hljs-keyword">from</span> dateutil.relativedelta <span class="hljs-keyword">import</span> WE, relativedelta

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_next_wednesday</span>():</span>
    today = date.today()
    delta = relativedelta(days=<span class="hljs-number">1</span>, weekday=WE(<span class="hljs-number">1</span>))
    next_wednesday = today + delta
    <span class="hljs-keyword">return</span> next_wednesday


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_timestamp</span>(<span class="hljs-params">str_time, tz</span>):</span>
    <span class="hljs-string">&quot;&quot;&quot;
    Args:
        str_time (str): Time to convert. Expects hours and minutes; seconds are optional.
          If AM/PM is not specified, a 24-hour clock is assumed.
        tz (str): 3-character timezone string.
    Returns:
        int: a UNIX timestamp (seconds from January 1, 1970 UTC) representing str_time, 
        next Wednesday from when the function is called.
    &quot;&quot;&quot;</span>

    tzinfo = {<span class="hljs-string">&#x27;EDT&#x27;</span>: tz.gettz(<span class="hljs-string">&#x27;US/Mountain&#x27;</span>),
              <span class="hljs-string">&#x27;CDT&#x27;</span>: tz.gettz(<span class="hljs-string">&#x27;US/Central&#x27;</span>),
              <span class="hljs-string">&#x27;MDT&#x27;</span>: tz.gettz(<span class="hljs-string">&#x27;US/Mountain&#x27;</span>)}
    str_time = str_time + <span class="hljs-string">&#x27; &#x27;</span> + tz
    n = get_next_wednesday()
    full_dt = str(n) + <span class="hljs-string">&#x27; &#x27;</span> + str_time
    timestamp = datetime.timestamp(parser.parse(full_dt, tzinfos=tzinfo))
    <span class="hljs-keyword">return</span> int(timestamp)
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="12" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="12" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Making the Call</h1>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-comment"># simplified example code</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">format_params</span>(<span class="hljs-params">record, ampm</span>):</span>
    params = {<span class="hljs-string">&#x27;key&#x27;</span>: GKEY, <span class="hljs-string">&#x27;mode&#x27;</span>: <span class="hljs-string">&#x27;transit&#x27;</span>}
    <span class="hljs-keyword">if</span> ampm==<span class="hljs-string">&#x27;am&#x27;</span>:
        <span class="hljs-comment"># add origin, destination, arrival time for AM</span>
        params[<span class="hljs-string">&#x27;origin&#x27;</span>] = <span class="hljs-string">&#x27;{}&#x27;</span>.format(record[<span class="hljs-string">&#x27;home_address&#x27;</span>])
        params[<span class="hljs-string">&#x27;destination&#x27;</span>] = <span class="hljs-string">&#x27;{}&#x27;</span>.format(record[<span class="hljs-string">&#x27;school_address&#x27;</span>])
        <span class="hljs-comment"># format arrival time to be school session time next Weds                                  </span>
        params[<span class="hljs-string">&#x27;arrival_time&#x27;</span>] = create_timestamp(record[<span class="hljs-string">&#x27;am_bell_time&#x27;</span>], record[<span class="hljs-string">&#x27;tz&#x27;</span>])
    <span class="hljs-keyword">return</span> params


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">query_dir_api</span>(<span class="hljs-params">params</span>):</span>
    data = {}
    r = requests.get(dir_api, params=params)
    <span class="hljs-keyword">if</span> r.status_code == <span class="hljs-number">200</span>:
        data = r.json()
    <span class="hljs-keyword">return</span> data


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">batch_process</span>(<span class="hljs-params">df, ampm</span>):</span>
    all_journeys = []
    <span class="hljs-keyword">for</span> idx, row <span class="hljs-keyword">in</span> df.iterrows():
        params = format_params(row, ampm)
        response = query_dir_api(params)
        all_journeys.append(response)
    <span class="hljs-keyword">return</span> all_journeys
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="13" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:55%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="vertical"><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/directions.png&quot;);background-size:100%;"></figure><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/no_directions.png&quot;);background-size:100%;"></figure></div></section></foreignObject><foreignObject width="45%" height="720"><section id="13" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="13" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:55%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h3>Caveat 1</h3>
<h2>Equivalent addresses and coordinates may yield different results</h2>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="13" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="14" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:55%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/pm_trip.png&quot;);background-size:95%;"></figure></div></section></foreignObject><foreignObject width="45%" height="720"><section id="14" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="14" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:55%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h3>Caveat 2</h3>
<h2>Results may meet the letter but not the spirit of the request</h2>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="14" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="15" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="15" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Google Directions Results</h1>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
    <span class="hljs-attr">&quot;geocoded_waypoints&quot;</span>: [...],
    <span class="hljs-attr">&quot;routes&quot;</span>: [
        {
          <span class="hljs-attr">&quot;legs&quot;</span>: [
               {
                   <span class="hljs-attr">&quot;arrival_time&quot;</span>: {<span class="hljs-attr">&quot;text&quot;</span>: <span class="hljs-string">&quot;3:16pm&quot;</span>, <span class="hljs-attr">&quot;time_zone&quot;</span>: <span class="hljs-string">&quot;America/Denver&quot;</span>, <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">1593641805</span>},
                   <span class="hljs-attr">&quot;departure_time&quot;</span>: {...},
                   <span class="hljs-attr">&quot;distance&quot;</span>: {<span class="hljs-attr">&quot;text&quot;</span>: <span class="hljs-string">&quot;7.2 mi&quot;</span>, <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">11586</span>},
                   <span class="hljs-attr">&quot;duration&quot;</span>: {<span class="hljs-attr">&quot;text&quot;</span>: <span class="hljs-string">&quot;43 mins&quot;</span>, <span class="hljs-attr">&quot;value&quot;</span>: <span class="hljs-number">2603</span>},
                   <span class="hljs-attr">&quot;end_address&quot;</span>: <span class="hljs-string">&quot;6209 Weems Ct, El Paso, TX 79905, USA&quot;</span>,
                   <span class="hljs-attr">&quot;end_location&quot;</span>: {...},
                   <span class="hljs-attr">&quot;start_address&quot;</span>: <span class="hljs-string">&quot;601 N Mesa St, El Paso, TX 79901, USA&quot;</span>,
                   <span class="hljs-attr">&quot;start_location&quot;</span>: {...},
                   <span class="hljs-attr">&quot;steps&quot;</span>: [...]
                }
            ],
            <span class="hljs-attr">&quot;overview_polyline&quot;</span>: {
                 <span class="hljs-attr">&quot;points&quot;</span>: <span class="hljs-string">&quot;woz`Evy}hS~F_FfFgEb@e@zBiB@M`BuAe@yCm@sEu@wESoAIe@IMi@eAa@w@HIIHgAoBsCeF
                 iBgDk@b@_@ZeA~@qC|BwByDaRu\\_OyWmGaLuLiTqDwGg@aAGi@DaFD_DBoAHe@?UU@]B{A@yDDqB@]Cu@W
                 UOm@w@a@iAe@aAGM_@]m@[SEg@CmBAsOCwKCAbGCj@RbAn@lA|AbC}@t@{@yAKSRQK[Uu@MY@SDI?[Ac@j@
                 ?xC?jCD`AChED|G@zIBvDLtBBxHIDk@FeG?eAC@?uC@gKDqXF}X@yR?iC?o@AaD@}A@yCNoAZm@vAmBfAsA
                 `@o@Lo@De@`@iFh@mGRaCDUbAcEnAgFpA}FzAsIRaARkA\\_CdBcMJ[PUNKHJJDN?LELSBOAOEMGKE}@BkD
                 Hy@JIDM@SAOIORgBt@sFTqB^cDvAiKdBgNxA{K|@yGn@{E\\kCB@B@DYLy@YCQEALyBEoCG?eJAk@&quot;</span>
              }
        }
    ],
    <span class="hljs-attr">&quot;status&quot;</span>: <span class="hljs-string">&quot;OK&quot;</span>
}
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="16" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="16" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Google Directions Results Components</h1>
<ul>
<li><code>status</code></li>
<li><code>geocoded_waypoints</code>
<ul>
<li>Geocoder status message</li>
<li>If a location was found, Google's place ID for it</li>
<li>If coordinates were passed, the reverse geocoding result</li>
</ul>
</li>
<li><code>routes</code>
<ul>
<li>By default only one route is returned</li>
<li><code>legs</code>: itinerary information</li>
<li><code>overview_polyline</code>: geographic shape</li>
</ul>
</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="17" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="17" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Great! But we can't map this.</h1>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="18" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:45%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="right"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="vertical"><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/sf_lines.png&quot;);background-size:90%;"></figure><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/sf_multilines.png&quot;);background-size:90%;"></figure><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/sf_polygons.png&quot;);background-size:90%;"></figure><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/sf_multipolygons.png&quot;);background-size:90%;"></figure></div></section></foreignObject><foreignObject width="55%" height="720"><section id="18" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="18" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:45%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="right">
<h1>Simple Features</h1>

<ul>
<li><a href="https://www.ogc.org/standards/sfa">ISO/OGC standard</a> for spatial data representation</li>
<li>Geometry types
<ul>
<li>Point and Multipoint</li>
<li>LineString and MultiLineString</li>
<li>Polygon and MultiPolygon</li>
<li>GeometryCollection</li>
</ul>
</li>
<li>Most geographic information systems use this model
<ul>
<li>Notable exceptions: raster data, OpenStreetMap</li>
</ul>
</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="18" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="19" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="19" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>geoJSON</h1>
<ul>
<li><a href="https://tools.ietf.org/html/rfc7946">Standardized format</a> for representing simple features</li>
</ul>
<p>Skeleton:</p>
<pre><code class="language-json"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>{
  <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;FeatureCollection&quot;</span>,
  <span class="hljs-attr">&quot;features&quot;</span>: [
    {
      <span class="hljs-attr">&quot;geometry&quot;</span>: {
         <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-string">&quot;LineString&quot;</span>,
         <span class="hljs-attr">&quot;coordinates&quot;</span>: [...]
        },
      <span class="hljs-attr">&quot;properties&quot;</span>: {...}
    }
  ]
}
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="20" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="20" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Decoding Polylines</h1>
<ul>
<li><a href="https://developers.google.com/maps/documentation/utilities/polylinealgorithm">https://developers.google.com/maps/documentation/utilities/polylinealgorithm</a></li>
<li><code>polyline</code> to the rescue</li>
</ul>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> polyline

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_overview_line</span>(<span class="hljs-params">api_response</span>):</span>
  route_line = api_response[<span class="hljs-string">&#x27;routes&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;overview_polyline&#x27;</span>][<span class="hljs-string">&#x27;points&#x27;</span>]
  pts = polyline.decode(route_line, geojson=<span class="hljs-literal">True</span>)
  <span class="hljs-keyword">return</span> pts
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="21" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="21" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Extracting Attributes</h1>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">extract_properties</span>(<span class="hljs-params">result</span>):</span>
    <span class="hljs-keyword">if</span> len(result[<span class="hljs-string">&#x27;routes&#x27;</span>]) &gt; <span class="hljs-number">0</span>:
        leg = result[<span class="hljs-string">&#x27;routes&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;legs&#x27;</span>][<span class="hljs-number">0</span>]
        start_address = leg[<span class="hljs-string">&#x27;start_address&#x27;</span>]
        end_address = leg[<span class="hljs-string">&#x27;end_address&#x27;</span>]
        <span class="hljs-comment"># account for walking-only routes not having departure and arrival times</span>
        dep_time = leg.get(<span class="hljs-string">&#x27;departure_time&#x27;</span>, {}).get(<span class="hljs-string">&#x27;text&#x27;</span>)
        arr_time = leg.get(<span class="hljs-string">&#x27;arrival_time&#x27;</span>, {}).get(<span class="hljs-string">&#x27;text&#x27;</span>)
        duration_minutes = round(leg[<span class="hljs-string">&#x27;duration&#x27;</span>][<span class="hljs-string">&#x27;value&#x27;</span>] / <span class="hljs-number">60</span>, <span class="hljs-number">1</span>)
        dist_miles = round(leg[<span class="hljs-string">&#x27;distance&#x27;</span>][<span class="hljs-string">&#x27;value&#x27;</span>] * <span class="hljs-number">0.00062137</span>, <span class="hljs-number">2</span>)
        properties = {<span class="hljs-string">&#x27;origin&#x27;</span>: start_address,
                      <span class="hljs-string">&#x27;dest&#x27;</span>: end_address,
                      <span class="hljs-string">&#x27;departure_time&#x27;</span>: dep_time,
                      <span class="hljs-string">&#x27;arrival_time&#x27;</span>: arr_time,
                      <span class="hljs-string">&#x27;total_minutes&#x27;</span>: duration_minutes,
                      <span class="hljs-string">&#x27;total_miles&#x27;</span>: dist_miles,
                      <span class="hljs-string">&#x27;notes&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span>}
    <span class="hljs-keyword">else</span>:   
        properties = {<span class="hljs-string">&#x27;notes&#x27;</span>: result[<span class="hljs-string">&#x27;status&#x27;</span>]}
    <span class="hljs-keyword">return</span> properties
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="22" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="22" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Putting It All Together</h1>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">make_feature</span>(<span class="hljs-params">result</span>):</span>
    <span class="hljs-string">&quot;&quot;&quot;Convert a Google Directions API result into a geoJSON feature.&quot;&quot;&quot;</span>
    obj = {<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;Feature&#x27;</span>}
    <span class="hljs-keyword">if</span> len(result[<span class="hljs-string">&#x27;routes&#x27;</span>]) &gt; <span class="hljs-number">0</span>:
        geom = extract_overview_line(result)
        obj[<span class="hljs-string">&#x27;geometry&#x27;</span>] = {<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;LineString&#x27;</span>,
                           <span class="hljs-string">&#x27;coordinates&#x27;</span>: geom}
    <span class="hljs-keyword">else</span>:
        obj[<span class="hljs-string">&#x27;geometry&#x27;</span>] = {<span class="hljs-string">&#x27;type&#x27;</span>: <span class="hljs-string">&#x27;GeometryCollection&#x27;</span>,
                           <span class="hljs-string">&#x27;coordinates&#x27;</span>: []}
    obj[<span class="hljs-string">&#x27;properties&#x27;</span>] = extract_properties(result)
    <span class="hljs-keyword">return</span> obj


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">gen_geojson</span>(<span class="hljs-params">data</span>):</span>
    <span class="hljs-string">&quot;&quot;&quot;Turn a list of Directions results into a geoJSON&quot;&quot;&quot;</span>
    out_geojson = {
        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;FeatureCollection&quot;</span>,
        <span class="hljs-string">&quot;features&quot;</span>: []
    }
    <span class="hljs-keyword">for</span> journey <span class="hljs-keyword">in</span> data:
        feature = make_feature(journey)
        out_geojson[<span class="hljs-string">&#x27;features&#x27;</span>].append(feature)

    <span class="hljs-keyword">return</span> out_geojson
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="23" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/decoded_polylines.png&quot;);background-size:100%;"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="23" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="23" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="content">
<h1>Results!</h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="23" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="24" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="24" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>That works for individual trips. What if I want something more general?</h1>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="25" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:40%;" data-marpit-advanced-background="background" data-marpit-advanced-background-split="left"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://docs.opentripplanner.org/en/latest/otp-logo.svg&quot;);background-size:90%;filter:opacity(0.5);"></figure></div></section></foreignObject><foreignObject width="60%" height="720" x="40%"><section id="25" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="25" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;--marpit-advanced-background-split:40%;" data-marpit-advanced-background="content" data-marpit-advanced-background-split="left">
<h1><a href="">OpenTripPlanner</a></h1>

<ul>
<li>Open source multimodal routing software written in Java</li>
<li>Works with OpenStreetMap and GTFS data</li>
<li>APIs for routing and isochrone creation</li>
<li>Excellent R resources: <code>otpr</code>, <code>opentripplanner</code>, <a href="https://github.com/marcusyoung/otp-tutorial">tutorial</a></li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="25" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="26" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/am_isos.png&quot;);background-size:92%;"></figure><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/pm_isos.png&quot;);background-size:92%;"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="26" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="26" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="content">
<h2></h2>
<h2></h2>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="26" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="27" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="27" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>One Little Problem...</h1>
<p><img src="https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/polygon_error.png" alt="img" /></p>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="28" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="28" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1><a href="https://geopandas.org/index.html">Geopandas</a> to the Rescue</h1>
<ul>
<li>Python library for spatial data manipulation</li>
<li>Think <code>pandas</code> with simple features support
<ul>
<li>Read/write spatial data files</li>
<li>Project coordinate reference systems</li>
<li>Perform spatial operations</li>
</ul>
</li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="29" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="29" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Geopandas DataFrames</h1>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> geopandas <span class="hljs-keyword">as</span> gpd

isos = gpd.read_file(<span class="hljs-string">&#x27;pm_isochrones.geojson&#x27;</span>)
print(isos)
</span></span></foreignObject></svg></code></pre>
<pre><code><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap>                               <span class="hljs-attribute">id</span>  time                                           geometry
<span class="hljs-attribute">0</span>  fid-<span class="hljs-number">1681139</span>f_<span class="hljs-number">172</span>e<span class="hljs-number">865</span>dd<span class="hljs-number">6</span>a_-<span class="hljs-number">7</span>ffc  <span class="hljs-number">5400</span>  MULTIPOLYGON (((-<span class="hljs-number">106</span>.<span class="hljs-number">53650</span> <span class="hljs-number">31</span>.<span class="hljs-number">81310</span>, -<span class="hljs-number">106</span>.<span class="hljs-number">5356</span>...
<span class="hljs-attribute">1</span>  fid-<span class="hljs-number">1681139</span>f_<span class="hljs-number">172</span>e<span class="hljs-number">865</span>dd<span class="hljs-number">6</span>a_-<span class="hljs-number">7</span>ffd  <span class="hljs-number">4500</span>  MULTIPOLYGON (((-<span class="hljs-number">106</span>.<span class="hljs-number">53650</span> <span class="hljs-number">31</span>.<span class="hljs-number">81310</span>, -<span class="hljs-number">106</span>.<span class="hljs-number">5356</span>...
<span class="hljs-attribute">2</span>  fid-<span class="hljs-number">1681139</span>f_<span class="hljs-number">172</span>e<span class="hljs-number">865</span>dd<span class="hljs-number">6</span>a_-<span class="hljs-number">7</span>ffe  <span class="hljs-number">3600</span>  MULTIPOLYGON (((-<span class="hljs-number">106</span>.<span class="hljs-number">52230</span> <span class="hljs-number">31</span>.<span class="hljs-number">81850</span>, -<span class="hljs-number">106</span>.<span class="hljs-number">5217</span>...
<span class="hljs-attribute">3</span>  fid-<span class="hljs-number">1681139</span>f_<span class="hljs-number">172</span>e<span class="hljs-number">865</span>dd<span class="hljs-number">6</span>a_-<span class="hljs-number">7</span>fff  <span class="hljs-number">2700</span>  MULTIPOLYGON (((-<span class="hljs-number">106</span>.<span class="hljs-number">44180</span> <span class="hljs-number">31</span>.<span class="hljs-number">79880</span>, -<span class="hljs-number">106</span>.<span class="hljs-number">4426</span>...
<span class="hljs-attribute">4</span>  fid-<span class="hljs-number">1681139</span>f_<span class="hljs-number">172</span>e<span class="hljs-number">865</span>dd<span class="hljs-number">6</span>a_-<span class="hljs-number">8000</span>  <span class="hljs-number">1800</span>  MULTIPOLYGON (((-<span class="hljs-number">106</span>.<span class="hljs-number">46880</span> <span class="hljs-number">31</span>.<span class="hljs-number">78890</span>, -<span class="hljs-number">106</span>.<span class="hljs-number">4695</span>...
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="30" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="30" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Shape Shifting</h1>
<ul>
<li>One operation that <em>does</em> work on malformed polygons: <strong>buffering</strong></li>
<li>Buffer creates an area <em>x</em> distance away from a shape</li>
<li>It also fixes our geometry errors</li>
</ul>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> geopandas <span class="hljs-keyword">as</span> gpd

isos = gpd.read_file(<span class="hljs-string">&#x27;pm_isochrones.geojson&#x27;</span>)
isos[<span class="hljs-string">&#x27;geometry&#x27;</span>] = isos.buffer(<span class="hljs-number">0</span>)
isos.to_file(<span class="hljs-string">&#x27;fixed_pm_isochrones.geojson&#x27;</span>, driver=<span class="hljs-string">&#x27;GeoJSON&#x27;</span>)
</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="31" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/spatial_overlay.png&quot;);"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="31" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="31" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="content">
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h2>Fixed Isochrones + Points</h2>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="31" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="32" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="background"><div data-marpit-advanced-background-container="true" data-marpit-advanced-background-direction="horizontal"><figure style="background-image:url(&quot;https://raw.githubusercontent.com/amfz/toronto-data-workshop/master/img/spatial_join.png&quot;);"></figure></div></section></foreignObject><foreignObject width="1280" height="720"><section id="32" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="32" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;" data-marpit-advanced-background="content">
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h1></h1>
<h2>Spatial Join Results</h2>
<footer>A Mahfouz</footer>
</section>
</foreignObject><foreignObject width="1280" height="720" data-marpit-advanced-background="pseudo"><section style="" data-marpit-advanced-background="pseudo" data-marpit-pagination="32" data-marpit-pagination-total="37"></section></foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="33" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="33" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Spatial Joining in Geopandas</h1>
<pre><code class="language-python"><svg data-marp-fitting="svg" data-marp-fitting-code><foreignObject><span data-marp-fitting-svg-content><span data-marp-fitting-svg-content-wrap><span class="hljs-keyword">import</span> geopandas <span class="hljs-keyword">as</span> gpd

isos = gpd.read_file(<span class="hljs-string">&#x27;fixed_pm_isochrones.geojson&#x27;</span>)
pts = gpd.read_file(<span class="hljs-string">&#x27;demo_pts.geojson&#x27;</span>)

pts_in_isos = gpd.sjoin(pts, isos, how=<span class="hljs-string">&#x27;left&#x27;</span>, op=<span class="hljs-string">&#x27;within&#x27;</span>)
pts_in_isos.to_file(<span class="hljs-string">&#x27;pm_joined.geojson&#x27;</span>, driver=<span class="hljs-string">&#x27;GeoJSON&#x27;</span>)

</span></span></foreignObject></svg></code></pre>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="34" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="34" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Thank you!</h1>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="35" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="35" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Useful links and references</h1>
<h4>Google Documentation</h4>
<ul>
<li>Directions API: <a href="https://developers.google.com/maps/documentation/directions/start">https://developers.google.com/maps/documentation/directions/start</a></li>
<li>Polyline encoding: <a href="https://developers.google.com/maps/documentation/utilities/polylinealgorithm">https://developers.google.com/maps/documentation/utilities/polylinealgorithm</a></li>
</ul>
<h4>OpenTripPlanner</h4>
<ul>
<li>OTP documentation: <a href="http://docs.opentripplanner.org/en/latest/">http://docs.opentripplanner.org/en/latest/</a></li>
<li>Isochrone API reference: <a href="http://dev.opentripplanner.org/apidoc/1.4.0/resource_LIsochrone.html">http://dev.opentripplanner.org/apidoc/1.4.0/resource_LIsochrone.html</a></li>
<li>Marcus Young's OTP tutorial in R: <a href="https://github.com/marcusyoung/otp-tutorial">https://github.com/marcusyoung/otp-tutorial</a></li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="36" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="36" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Useful links and references</h1>
<h4>Python Libraries</h4>
<ul>
<li>requests: <a href="https://requests.readthedocs.io/en/master/">https://requests.readthedocs.io/en/master/</a></li>
<li>geopandas: <a href="https://geopandas.org/index.html">https://geopandas.org/index.html</a></li>
<li>dateutil: <a href="https://dateutil.readthedocs.io/en/stable/">https://dateutil.readthedocs.io/en/stable/</a></li>
<li>polyline: <a href="https://pypi.org/project/polyline/">https://pypi.org/project/polyline/</a></li>
</ul>
<h4>Spatial Data</h4>
<ul>
<li>Simple Features: <a href="https://www.ogc.org/standards/sfa">https://www.ogc.org/standards/sfa</a></li>
<li>geoJSON: <a href="https://geojson.org/">https://geojson.org/</a></li>
<li>Spatial reference systems: <a href="https://epsg.io/">https://epsg.io/</a></li>
</ul>
<footer>A Mahfouz</footer>
</section>
</foreignObject></svg><svg data-marpit-svg="" viewBox="0 0 1280 720"><foreignObject width="1280" height="720"><section id="37" data-footer="A Mahfouz" data-paginate="true" data-theme="default" data-marpit-pagination="37" data-marpit-pagination-total="37" style="--footer:A Mahfouz;--paginate:true;--theme:default;">
<h1>Useful links and references</h1>
<h4>GIS Software</h4>
<ul>
<li>QGIS: <a href="https://www.qgis.org/en/site/">https://www.qgis.org/en/site/</a></li>
</ul>
<h4>Misc</h4>
<ul>
<li>This presentation was made with Marp: <a href="https://marp.app/">https://marp.app/</a></li>
</ul>
<footer>A Mahfouz</footer>
</section>
<script>!function(){"use strict";function t(t){Array.from(document.querySelectorAll("svg[data-marpit-svg]"),e=>{const{children:r,clientHeight:i,clientWidth:o,viewBox:n}=e;e.style.transform||(e.style.transform="translateZ(0)");const a=t||e.currentScale||1,s=n.baseVal.width/a,l=n.baseVal.height/a,c=Math.min(i/l,o/s);for(let t=0;t<r.length;t+=1){const{style:e}=r[t].firstChild;e.position||(e.position="fixed"),e.transformOrigin||(e.transformOrigin="0 0"),e.transform=`scale(${c}) translateZ(0)`}})}const e=(t,e,r)=>{if(t.getAttribute(e)!==r)return t.setAttribute(e,r),!0};function r(i=!0){for(const e of"Apple Computer, Inc."===navigator.vendor?[t]:[])e();Array.from(document.querySelectorAll('svg[data-marp-fitting="svg"]'),t=>{const r=t.firstChild,i=r.firstChild,{scrollWidth:o,scrollHeight:n}=i;let a,s=1;if(t.hasAttribute("data-marp-fitting-code")&&(a=t.parentElement.parentElement),t.hasAttribute("data-marp-fitting-math")&&(a=t.parentElement),a){const t=getComputedStyle(a),e=Math.ceil(a.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight));e&&(s=e)}const l=Math.max(o,s),c=Math.max(n,1),d=`0 0 ${l} ${c}`;e(r,"width",""+l),e(r,"height",""+c),e(t,"preserveAspectRatio",getComputedStyle(t).getPropertyValue("--preserve-aspect-ratio")||"xMinYMin meet"),e(t,"viewBox",d)&&t.classList.toggle("__reflow__")}),i&&window.requestAnimationFrame(()=>r(i))}!function(){if("undefined"==typeof window)throw new Error("Marp Core's browser script is valid only in browser context.");window.marpCoreBrowserScript?console.warn("Marp Core's browser script has already executed."):(Object.defineProperty(window,"marpCoreBrowserScript",{value:!0}),r())}()}();
</script></foreignObject></svg></div><div class="bespoke-marp-note" data-index="0" tabindex="0"><p>Hi, I'm A and I'll be breaking the R streak to talk a bit about working with geographic data in Python.</p></div><div class="bespoke-marp-note" data-index="1" tabindex="0"><p>An outline of what I'll be talking about today: a little about me, to break the ice, a broad description of the work, and then I'll cover two workflows involved</p></div><div class="bespoke-marp-note" data-index="2" tabindex="0"><p>About me: Like Rohan said, I'm currently a master of information student at U of T. My background is in geography and history. I drifted into data stuff via GIS -- people would hire me to make maps.</p></div><div class="bespoke-marp-note" data-index="3" tabindex="0"><p>This talk draws from work doing transit analysis for some schools in the US. The specific questions and the work involved varied from school to school, but questions generally fell into two bins. The first involved details of individual commutes: if students took public transit, how long would the trip take, how many times would they have to transfer, how far would they have to walk. The second category focused on general transit accessibility: questions of what parts of the city are within reasonable commutes via transit. What constituted 'reasonable' could vary.</p></div><div class="bespoke-marp-note" data-index="4" tabindex="0"><p>To answer these questions, we used the Google Directions API, OpenTripPlanner, Python, and QGIS, but all of this is doable in R, and frankly I think some aspects might be easier in R.</p></div><div class="bespoke-marp-note" data-index="5" tabindex="0"><p>Along the way, I'll touch upon a general Python workflow for getting data from APIs, with a detour into UNIX time and timezones. We'll build our own dataset from the results, which will require learning a little about spatial data representation and common file formats. And finally, we'll look at a simple spatial operation.</p></div><div class="bespoke-marp-note" data-index="6" tabindex="0"><p>To quickly describe the inputs, we got data describing schools -- including school name, address, and bell times -- and datasets about students, with varying states of quality, so a lot of data cleaning and joining occurred even before getting to the API calling stage. Just as a note, none of the data shown here is actual student data, and most of the locations aren't even schools, either.</p></div><div class="bespoke-marp-note" data-index="7" tabindex="0"><p>One common task I won't be going into is geocoding, aka converting addresses into coordinates. It isn't necessary for working with the Directions API, and you can actually extract coordinates from Directions API results.

But if it is necessary to geocode separately, Google's geocoder is quite error-tolerant. That error tolerance means we can pass in an intersection, or just a ZIP code, or fudge student addresses by incrementing the house numbers by a  random integer, and still get usable results.

Some other options include Nominatim, which is built off of OpenStreetMap, and private vendors like Mapbox or HERE.</p></div><div class="bespoke-marp-note" data-index="8" tabindex="0"><p>As I mentioned, we used Google Directions to generate indiviual trips. It's not necessarily the best option, but it was chosen for two related reasons. One, people tend to take Google results for the truth, and two, the results are easy to verify. If anyone thinks a result looks funny, they can go and confirm it.

To make API calls, we used the requests library. It's a versatile python library for HTTP requests, so we actually used it to interface with OpenTripPlanner as well. There is a Python Google Maps client, but it doesn't return the full API response, and we wanted some of the pieces it leaves out.

If you've ever gotten directions from Google, you can guess the parameters needed to pass to the API. Besides the key, there's the origin and destination locations, which can be addresses.  To answer our questions, we also had to specify the travel mode -- transit here -- and either the arrival time for AM trips or the departure time for PM trips.</p></div><div class="bespoke-marp-note" data-index="9" tabindex="0"><p>But there's a catch. The times need to be in UNIX time, which is the number of seconds since midnight on January 1, 1970, Coordinated Universal Time. The bell times we have are all in text. We don't have dates, and the specific date chosen doesn't matter too much. Since we're interested in commutes, and transit schedules differ on weekends and holidays, we need to use non-holiday weekdays. The dates can't be too far into the past or future, either. And, just for added fun, the schools are in different timezones.</p></div><div class="bespoke-marp-note" data-index="10" tabindex="0"><p>We didn't want to hard code UNIX dates into the script, so from the department of over-engineering came a couple of helper functions to turn bell times into that time next Wednesday. Wednesday was chosen just because there weren't any holidays coming up on Wednesdays. Shout-out to the dateutil library for doing the heavy lifting here.</p></div><div class="bespoke-marp-note" data-index="11" tabindex="0"><p>Finally, we're set to make API calls. I'm not going to dwell too long here -- it's a fairly standard workflow of iterating through a pandas DataFrame containing the data to make calls, formatting the parameters, making the request, parsing the results into json objects and writing them to file.</p></div><div class="bespoke-marp-note" data-index="12" tabindex="0"><p>Before looking at the results, I want to mention two caveats. First, I got better results passing in addresses than coordinates, even when those coordinates came from Google. We geocoded the schools for something else and figured may as well use the coordinates because they're more precise, but the results ended up being worse. On the right is an extreme example replicated in the web interface. They're results for the same journey, the only difference is up top two addresses were supplied, while at the bottom I entered the coordinates I got from Google's geocoder for the same address.</p></div><div class="bespoke-marp-note" data-index="13" tabindex="0"><p>Second caveat is check all the trip attributes because the API really wants to return a result, even if it's not appropriate for your purpose. So here, we wanted to model a morning commute, arriving at the destination by 7:30 AM. Google did get a response....you just have to overnight it at your destination.</p></div><div class="bespoke-marp-note" data-index="14" tabindex="0"><p>So, when results come back successfully, they look something like this. 

You have the status at the bottom -- here it's okay, but if one of the points couldn't be found or there aren't any results, the status will reflect that. 

Up top are the geocoded waypoints. If you give addresses, this section will just have google's proprietary place IDs and some place categories. If you supply coordinates, they'll reverse geocode here. 

The key part is the routes section. By default, there will only be one route in the result. 

Within the route, the key pieces are an overview polyline representing the shape of the journey, and the legs attribute, which contains overall trip distance, duration, start and end locations, and steps, which break down the trip down further. Our trips only have a start and endpoint, with no intermediate stops, so there is only one leg.

In the leg, the steps attribute contains detailed information like what routes are taken, what turns to make, and which parts of the journey are walking, transit, etc.</p></div><div class="bespoke-marp-note" data-index="15" tabindex="0"><p></p></div><div class="bespoke-marp-note" data-index="16" tabindex="0"><p>All this is great, but we can't map this as-is. In order to get it to a mappable state, we need to talk about spatial data representation.</p></div><div class="bespoke-marp-note" data-index="17" tabindex="0"><p>The most common spatial data model is the simple features model. Simple features is an ISO/OGC standard for vector data -- geographic data that can be represented as discrete objects. 

Spatially, data can be modeled as points -- for example, cities -- 

lines -- e.g. streets or rivers -- 

or polygons, like park space or countries. 

The multi- variants are for entities like, say, Japan, that are best represented with more than one shape. 

Finally, a geometry collection is a catch-all for heterogenous shapes. 

No matter what though, geometries are represented with coordinate pairs, so that polyline string isn't going to cut it. 

Most geographic information systems and mapping software use this model, or a variant. Some big exceptions are raster data, so things like temperatures or elevations that are better modeled as continuous fields, and OpenStreetMap, which uses its own data model that better serves its purposes. Moving between OSM and simple features is a common enough task that there are several tools to help with the conversion. It's just good to know that that is a step.</p></div><div class="bespoke-marp-note" data-index="18" tabindex="0"><p>There are file formats that are simple features compliant. We decided to convert the API results into geoJSON. 

GeoJSON, like JSON, is relatively easy to create programmatically. 

Up here is a basic skeleton -- we specify that the file is a feature collection, rather than a single feature. 

Then features contains a list of the features. Each feature consists of a geometry attribute, where we'll need to put in the coordinate pairs, and properties, where we'll put trip attributes like duration.</p></div><div class="bespoke-marp-note" data-index="19" tabindex="0"><p>First, we need to get the polylines into coordinate pairs. Google documented the encoding algorithm, but instead of reinventing the wheel, we used the polyline library to write a decoding function.</p></div><div class="bespoke-marp-note" data-index="20" tabindex="0"><p>Then, another function to extract the attributes,</p></div><div class="bespoke-marp-note" data-index="21" tabindex="0"><p>and finally pop geometries and properties into a feature and add it to the features list. From there we wrote them to file.</p></div><div class="bespoke-marp-note" data-index="22" tabindex="0"><p>So, for a much simpler dummy dataset, the geoJSONs look like this. From there, they can be put on a map and styled by whatever attribute is of interest. Here, trips that are more than half an hour long are orange, while shorter ones are purple. The trip to the southwest corner of the map is the polyline in the example result earlier.</p></div><div class="bespoke-marp-note" data-index="23" tabindex="0"><p>So that gets us mappable data for individual trips. But what if the question is more general? What if, instead of focusing on individual trips, we wanted to show what parts of the city are within reasonable commuting times? In other words, we need isochrones.</p></div><div class="bespoke-marp-note" data-index="24" tabindex="0"><p>Google doesn't have an API for that. Really, for transit isocrhones, low-cost API options are slim. So we went with OpenTripPlanner, which is open source, Java-based multimodal routing software. It works with OpenStreetMap data and GTFS, or generalized transit feed specification, data. It's meant to run server-side, so there are API endpoints for routing and isochrone creation, which means we can interact with it using requests. For the R users in the audience, there are excellent resources.</p></div><div class="bespoke-marp-note" data-index="25" tabindex="0"><p>Building the router and calling the API could be its own talk, so in the interest of time I'll cut to what the isochrones look like. These were morning and afternoon isochrones for 15-minute intervals from 30 to 90 minutes. There were some additional restrictions, like capping the amount of walking, but you can see that this city's transit system really wasn't designed for early school starts.</p></div><div class="bespoke-marp-note" data-index="26" tabindex="0"><p>There is a hiccup here. When I handed the files off to a colleague to work with in QGIS, this happened. 

The error is a bit small, but it says that there is an invalid geometry.

It turns out that the isochrones look good, but they don't always comply with the simple feature specification. They sometimes do things polygons aren't supposed to do, like intersect themselves. 

When shapes don't follow the simple features spec, you can still map them, but you can get errors like this when you try to perform spatial operations.</p></div><div class="bespoke-marp-note" data-index="27" tabindex="0"><p>The problem is fixable within QGIS, but you don't want to do this for hundreds of files. 

Fortunately, there's a hacky-but-simple fix in Python. We'll need to geopandas library to do this. Geopandas essentially extends pandas and its data frame model to provide support for simple features -- points, lines, and polygons. 

It's useful for reading and writing spatial data files, managing coordinate reference systems, and performing spatial operations. 

Just a quick aside about spatial reference systems -- they're important, but because all the data here is meant to work on web maps, they have the same reference system.</p></div><div class="bespoke-marp-note" data-index="28" tabindex="0"><p>If you load spatial data to a geopandas dataframe you get something like this. You'll have whatever attributes from the data, with the shape represented as a geometry attribute like we've got all the way to the right here.</p></div><div class="bespoke-marp-note" data-index="29" tabindex="0"><p>One operation that does work is buffering. What buffers normally do is create an area x distance away from a shape as-the-crow-flies. So, for example, everything in a 1-km radius of a point, or the area within 100 miles of a border. Here, we'll just buffer by 0 to fix the geometry errors.</p></div><div class="bespoke-marp-note" data-index="30" tabindex="0"><p>It's kind of hard to show the lack of an error message, but now that the polygons are all sorted out it's possible to perform spatial operations on them. Because the OTP isochrones give you more control over constraints than google directions, one question that pops up is which students or stops fall within reasonable commuting range.

This is something that can be answered using a spatial join. Just like an regular join merges datasets based on the relationships between attribute values, a spatial join merges datasets based on spatial relationships between records.

So here are some randomly generated points over the data...</p></div><div class="bespoke-marp-note" data-index="31" tabindex="0"><p>...and here's what the result of a spatial join looks like. Points are color-coded by the isochrone they fall in. So you don't have the particulars of individual journeys, but you do get an understanding of commutes and mobility for no API credits.</p></div><div class="bespoke-marp-note" data-index="32" tabindex="0"><p>And just to round things out, this is easily doable within geopandas.</p></div><script>!function(){"use strict";var e=function(e,t){var n,r=1===(e.parent||e).nodeType?e.parent||e:document.querySelector(e.parent||e),s=[].filter.call("string"==typeof e.slides?r.querySelectorAll(e.slides):e.slides||r.children,(function(e){return"SCRIPT"!==e.nodeName})),a={},o=function(e,t){return(t=t||{}).index=s.indexOf(e),t.slide=e,t},i=function(e,t){a[e]=(a[e]||[]).filter((function(e){return e!==t}))},l=function(e,t){return(a[e]||[]).reduce((function(e,n){return e&&!1!==n(t)}),!0)},c=function(e,t){s[e]&&(n&&l("deactivate",o(n,t)),n=s[e],l("activate",o(n,t)))},d=function(e,t){var r=s.indexOf(n)+e;l(e>0?"next":"prev",o(n,t))&&c(r,t)},u={off:i,on:function(e,t){return(a[e]||(a[e]=[])).push(t),i.bind(null,e,t)},fire:l,slide:function(e,t){if(!arguments.length)return s.indexOf(n);l("slide",o(s[e],t))&&c(e,t)},next:d.bind(null,1),prev:d.bind(null,-1),parent:r,slides:s,destroy:function(e){l("destroy",o(n,e)),a={}}};return(t||[]).forEach((function(e){e(u)})),n||c(0),u};function t(e){e.parent.classList.add("bespoke-marp-parent"),e.slides.map(e=>e.classList.add("bespoke-marp-slide")),e.on("activate",t=>{const n=!t.slide.classList.contains("bespoke-marp-active");e.slides.map(e=>{e.classList.remove("bespoke-marp-active")}),t.slide.classList.add("bespoke-marp-active"),n&&(t.slide.classList.add("bespoke-marp-active-ready"),document.body.clientHeight,t.slide.classList.remove("bespoke-marp-active-ready"))})}function n(e=2e3){return t=>{let n;function r(){n&&clearTimeout(n),n=setTimeout(()=>{t.parent.classList.add("bespoke-marp-inactive")},e),t.parent.classList.remove("bespoke-marp-inactive")}document.addEventListener("mousedown",r),document.addEventListener("mousemove",r),document.addEventListener("touchend",r),setTimeout(r,0)}}const r=["AUDIO","BUTTON","INPUT","SELECT","TEXTAREA","VIDEO"];function s(e){e.parent.addEventListener("keydown",e=>{if(!e.target)return;const t=e.target;(r.includes(t.nodeName)||"true"===t.contentEditable)&&e.stopPropagation()})}function a(e){window.addEventListener("load",()=>{for(const t of e.slides){const e=t.querySelector("[data-marp-fitting]")?"":"hideable";t.setAttribute("data-bespoke-marp-load",e)}})}function o(e){let t=0,n=0;Object.defineProperty(e,"fragments",{enumerable:!0,value:e.slides.map(e=>[null,...e.querySelectorAll("[data-marpit-fragment]")])});const r=r=>void 0!==e.fragments[t][n+r],s=(r,s)=>{t=r,n=s,e.fragments.forEach((e,t)=>{e.forEach((e,n)=>{if(null==e)return;const a=t<r||t===r&&n<=s;e.setAttribute("data-bespoke-marp-fragment",a?"active":"inactive"),t===r&&n===s?e.setAttribute("data-bespoke-marp-current-fragment","current"):e.removeAttribute("data-bespoke-marp-current-fragment")})}),e.fragmentIndex=s;const a={slide:e.slides[r],index:r,fragments:e.fragments[r],fragmentIndex:s};e.fire("fragment",a)};e.on("next",()=>{if(r(1))return s(t,n+1),!1;const a=t+1;e.fragments[a]&&s(a,0)}),e.on("prev",()=>{if(r(-1))return s(t,n-1),!1;const a=t-1;e.fragments[a]&&s(a,e.fragments[a].length-1)}),e.on("slide",({index:t,fragment:n})=>{let r=0;if(void 0!==n){const s=e.fragments[t];if(s){const{length:e}=s;r=-1===n?e-1:Math.min(Math.max(n,0),e-1)}}s(t,r)}),s(0,0)}var i,l=function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}((function(e){
/*!
  * screenfull
  * v5.0.2 - 2020-02-13
  * (c) Sindre Sorhus; MIT License
  */
!function(){var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,s=n.length,a={};r<s;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)a[n[0][r]]=e[r];return a}return!1}(),s={change:r.fullscreenchange,error:r.fullscreenerror},a={request:function(e){return new Promise(function(n,s){var a=function(){this.off("change",a),n()}.bind(this);this.on("change",a);var o=(e=e||t.documentElement)[r.requestFullscreen]();o instanceof Promise&&o.then(a).catch(s)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var s=function(){this.off("change",s),e()}.bind(this);this.on("change",s);var a=t[r.exitFullscreen]();a instanceof Promise&&a.then(s).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=s[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=s[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=a:window.screenfull=a):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}));function c(e){e.fullscreen=()=>{l.isEnabled&&l.toggle(document.body)},document.addEventListener("keydown",t=>{70!==t.which&&122!==t.which||t.altKey||t.ctrlKey||t.metaKey||!l.isEnabled||(e.fullscreen(),t.preventDefault())})}function d(e={}){const t=Object.assign({interval:200},e);return e=>{document.addEventListener("keydown",t=>{(32===t.which&&t.shiftKey||33===t.which||37===t.which||38===t.which)&&e.prev(),(32===t.which&&!t.shiftKey||34===t.which||39===t.which||40===t.which)&&e.next(),35===t.which&&e.slide(e.slides.length-1,{fragment:-1}),36===t.which&&e.slide(0)});let n,r,s=0;e.parent.addEventListener("wheel",a=>{let o=!1;const l=(e,t)=>{e&&(o=o||function(e,t){return function(e,t){const n=t===i.X?"Width":"Height";return e["client"+n]<e["scroll"+n]}(e,t)&&function(e,t){const{overflow:n}=e,r=e["overflow"+t];return"auto"===n||"scroll"===n||"auto"===r||"scroll"===r}(getComputedStyle(e),t)}(e,t)),(null==e?void 0:e.parentElement)&&l(e.parentElement,t)};if(0!==a.deltaX&&l(a.target,i.X),0!==a.deltaY&&l(a.target,i.Y),o)return;a.preventDefault(),r&&clearTimeout(r),r=setTimeout(()=>{n=0},t.interval);const c=Date.now()-s<t.interval,d=Math.sqrt(Math.pow(a.deltaX,2)+Math.pow(a.deltaY,2)),u=d<=n;if(n=d,c||u)return;let f;(a.deltaX>0||a.deltaY>0)&&(f="next"),(a.deltaX<0||a.deltaY<0)&&(f="prev"),f&&(e[f](),s=Date.now())})}}!function(e){e.X="X",e.Y="Y"}(i||(i={}));const u=(...e)=>history.replaceState(...e);var f;!function(e){e.Normal="",e.Presenter="presenter",e.Next="next"}(f||(f={}));const p=(e,{protocol:t,host:n,pathname:r,hash:s}=location)=>{const a=e.toString();return`${t}//${n}${r}${a?"?":""}${a}${s}`},m=()=>{switch(document.body.getAttribute("data-bespoke-view")){case f.Normal:return f.Normal;case f.Presenter:return f.Presenter;case f.Next:return f.Next;default:throw new Error("View mode is not assigned.")}},h=e=>new URLSearchParams(location.search).get(e),g=(e,t={})=>{const n=Object.assign({location:location,setter:u},t),r=new URLSearchParams(n.location.search);for(const t of Object.keys(e)){const n=e[t];"string"==typeof n?r.set(t,n):r.delete(t)}try{n.setter(null,document.title,p(r,n.location))}catch(e){console.error(e)}},b={available:(()=>{try{return localStorage.setItem("bespoke-marp","bespoke-marp"),localStorage.removeItem("bespoke-marp"),!0}catch(e){return console.warn("Warning: Using localStorage is restricted in the current host so some features may not work."),!1}})(),get:e=>{try{return localStorage.getItem(e)}catch(e){return null}},set:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(e){return!1}},remove:e=>{try{return localStorage.removeItem(e),!0}catch(e){return!1}}};function v(e=".bespoke-marp-osc"){const t=document.querySelector(e);if(!t)return()=>{};const n=(e,n)=>{t.querySelectorAll(`[data-bespoke-marp-osc=${JSON.stringify(e)}]`).forEach(n)};return l.isEnabled||n("fullscreen",e=>e.style.display="none"),b.available||n("presenter",e=>{e.disabled=!0,e.title="Presenter view is disabled due to restricted localStorage."}),e=>{t.addEventListener("click",t=>{if(t.target instanceof HTMLElement){const{bespokeMarpOsc:n}=t.target.dataset;switch(n&&t.target.blur(),n){case"next":e.next();break;case"prev":e.prev();break;case"fullscreen":"function"==typeof e.fullscreen&&l.isEnabled&&e.fullscreen();break;case"presenter":e.openPresenterView()}}}),e.parent.appendChild(t),e.on("activate",({index:t})=>{n("page",n=>n.textContent=`Page ${t+1} of ${e.slides.length}`)}),e.on("fragment",({index:t,fragments:r,fragmentIndex:s})=>{n("prev",e=>e.disabled=0===t&&0===s),n("next",n=>n.disabled=t===e.slides.length-1&&s===r.length-1)}),l.isEnabled&&l.onchange(()=>n("fullscreen",e=>e.classList.toggle("exit",l.isEnabled&&l.isFullscreen)))}}function w(){const e=Math.max(Math.floor(.85*window.innerWidth),640),t=Math.max(Math.floor(.85*window.innerHeight),360);return window.open(this.presenterUrl,"bespoke-marp-presenter-"+this.syncKey,`width=${e},height=${t},menubar=no,toolbar=no`)}function y(){const e=new URLSearchParams(location.search);return e.set("view","presenter"),e.set("sync",this.syncKey),p(e)}var x=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];let E=e=>String(e).replace(/[&<>"']/g,e=>`&${k[e]};`),k={"&":"amp","<":"lt",">":"gt",'"':"quot","'":"apos"},L="dangerouslySetInnerHTML",S={className:"class",htmlFor:"for"},I={};function P(e,t){let n=[],r="";t=t||{};for(let e=arguments.length;e-- >2;)n.push(arguments[e]);if("function"==typeof e)return t.children=n.reverse(),e(t);if(e){if(r+="<"+e,t)for(let e in t)!1!==t[e]&&null!=t[e]&&e!==L&&(r+=` ${S[e]?S[e]:E(e)}="${E(t[e])}"`);r+=">"}if(-1===x.indexOf(e)){if(t[L])r+=t[L].__html;else for(;n.length;){let e=n.pop();if(e)if(e.pop)for(let t=e.length;t--;)n.push(e[t]);else r+=!0===I[e]?e:E(e)}r+=e?`</${e}>`:""}return I[r]=!0,r}const M=({children:e})=>P(null,null,...e),N="bespoke-marp-presenter-container",F="bespoke-marp-presenter-next",O="bespoke-marp-presenter-next-container",q="bespoke-marp-presenter-note-container",T="bespoke-marp-presenter-info-container",C="bespoke-marp-presenter-info-page",$="bespoke-marp-presenter-info-page-text",j="bespoke-marp-presenter-info-page-prev",A="bespoke-marp-presenter-info-page-next",K="bespoke-marp-presenter-info-time",R="bespoke-marp-presenter-info-timer";function U(e){const{title:t}=document;document.title="[Presenter view]"+(t?" - "+t:"");const n={},r=e=>(n[e]=n[e]||document.querySelector("."+e),n[e]);document.body.appendChild((e=>{const t=document.createElement("div");return t.className=N,t.appendChild(e),t.insertAdjacentHTML("beforeend",P(M,null,P("div",{class:O},P("iframe",{class:F,src:"?view=next"})),P("div",{class:q}),P("div",{class:T},P("div",{class:C},P("button",{class:j,tabindex:"-1",title:"Previous"},"Previous"),P("span",{class:$}),P("button",{class:A,tabindex:"-1",title:"Next"},"Next")),P("time",{class:K,title:"Current time"}),P("div",{class:R})))),t})(e.parent)),(e=>{r(O).addEventListener("click",()=>e.next());const t=r(F),n=(s=t,(e,t)=>s.contentWindow.postMessage(`navigate:${e},${t}`,"null"===window.origin?"*":window.origin));var s;t.addEventListener("load",()=>{r(O).classList.add("active"),n(e.slide(),e.fragmentIndex),e.on("fragment",({index:e,fragmentIndex:t})=>n(e,t))});const a=document.querySelectorAll(".bespoke-marp-note");a.forEach(e=>{e.addEventListener("keydown",e=>e.stopPropagation()),r(q).appendChild(e)}),e.on("activate",()=>a.forEach(t=>t.classList.toggle("active",t.dataset.index==e.slide()))),e.on("activate",({index:t})=>{r($).textContent=`${t+1} / ${e.slides.length}`});const o=r(j),i=r(A);o.addEventListener("click",()=>{o.blur(),e.prev()}),i.addEventListener("click",()=>{i.blur(),e.next()}),e.on("fragment",({index:t,fragments:n,fragmentIndex:r})=>{o.disabled=0===t&&0===r,i.disabled=t===e.slides.length-1&&r===n.length-1});const l=()=>r(K).textContent=(new Date).toLocaleTimeString();l(),setInterval(l,250)})(e)}function D(e){const t=m();return t===f.Next&&e.appendChild(document.createElement("span")),e=>{t===f.Normal&&function(e){if(!(e=>e.syncKey&&"string"==typeof e.syncKey)(e))throw new Error("The current instance of Bespoke.js is invalid for Marp bespoke presenter plugin.");Object.defineProperties(e,{openPresenterView:{enumerable:!0,value:w},presenterUrl:{enumerable:!0,get:y}}),b.available&&document.addEventListener("keydown",t=>{80!==t.which||t.altKey||t.ctrlKey||t.metaKey||(t.preventDefault(),e.openPresenterView())})}(e),t===f.Presenter&&U(e),t===f.Next&&function(e){const t=t=>{if(t.origin!==window.origin)return;const[n,r]=t.data.split(":");if("navigate"===n){const[t,n]=r.split(",");let s=Number.parseInt(t,10),a=Number.parseInt(n,10)+1;a>=e.fragments[s].length&&(s+=1,a=0),e.slide(s,{fragment:a})}};window.addEventListener("message",t),e.on("destroy",()=>window.removeEventListener("message",t))}(e)}}function V(e){e.on("activate",t=>{document.querySelectorAll(".bespoke-progress-bar").forEach(n=>{n.style.flexBasis=100*t.index/(e.slides.length-1)+"%"})})}const X=e=>{const t=Number.parseInt(e,10);return Number.isNaN(t)?null:t};function Y(e={}){const t=Object.assign({history:!0},e);return e=>{let n=!0;const r=e=>{const t=n;try{return n=!0,e()}finally{n=t}},s=(t={fragment:!0})=>{((t,n)=>{const{fragments:r,slides:s}=e,a=Math.max(0,Math.min(t,s.length-1)),o=Math.max(0,Math.min(n||0,r[a].length-1));a===e.slide()&&o===e.fragmentIndex||e.slide(a,{fragment:o})})((X(location.hash.slice(1))||1)-1,t.fragment?X(h("f")||""):null)};e.on("fragment",({index:e,fragmentIndex:r})=>{n||g({f:0===r||r.toString()},{location:Object.assign(Object.assign({},location),{hash:"#"+(e+1)}),setter:(...e)=>t.history?history.pushState(...e):history.replaceState(...e)})}),setTimeout(()=>{s(),window.addEventListener("hashchange",()=>r(()=>{s({fragment:!1}),g({f:void 0})})),window.addEventListener("popstate",()=>{n||r(()=>s())}),n=!1},0)}}function B(e={}){const t=e.key||((e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t})(),n="bespoke-marp-sync-"+t,r=()=>{const e=b.get(n);return e?JSON.parse(e):Object.create(null)},s=e=>{const t=r(),s=Object.assign(Object.assign({},t),e(t));return b.set(n,JSON.stringify(s)),s};return s(e=>({reference:(e.reference||0)+1})),e=>{Object.defineProperty(e,"syncKey",{value:t,enumerable:!0});let a=!0;setTimeout(()=>{e.on("fragment",e=>{a&&s(()=>({index:e.index,fragmentIndex:e.fragmentIndex}))})},0),window.addEventListener("storage",t=>{if(t.key===n&&t.oldValue&&t.newValue){const n=JSON.parse(t.oldValue),r=JSON.parse(t.newValue);if(n.index!==r.index||n.fragmentIndex!==r.fragmentIndex)try{a=!1,e.slide(r.index,{fragment:r.fragmentIndex})}finally{a=!0}}}),e.on("destroy",()=>{const{reference:e}=r();void 0===e||e<=1?b.remove(n):s(()=>({reference:e-1}))})}}function z(e={}){const t=Object.assign({slope:Math.tan(-35*Math.PI/180),swipeThreshold:30},e);return e=>{let n;const r=e.parent,s=e=>{const t=r.getBoundingClientRect();return{x:e.pageX-(t.left+t.right)/2,y:e.pageY-(t.top+t.bottom)/2}};r.addEventListener("touchstart",e=>{n=1===e.touches.length?s(e.touches[0]):void 0},{passive:!0}),r.addEventListener("touchmove",e=>{if(n)if(1===e.touches.length){e.preventDefault();const t=s(e.touches[0]),r=t.x-n.x,a=t.y-n.y;n.delta=Math.sqrt(Math.pow(Math.abs(r),2)+Math.pow(Math.abs(a),2)),n.radian=Math.atan2(r,a)}else n=void 0}),r.addEventListener("touchend",r=>{if(n){if(n.delta&&n.delta>=t.swipeThreshold){let s=n.radian-t.slope;s=(s+Math.PI)%(2*Math.PI)-Math.PI,e[s<0?"next":"prev"](),r.stopPropagation()}n=void 0}},{passive:!0})}}const H=[f.Normal,f.Presenter,f.Next];!function(r=document.getElementById("p")){document.body.setAttribute("data-bespoke-view",(()=>{switch(h("view")){case"next":return f.Next;case"presenter":return f.Presenter;default:return f.Normal}})());const i=(e=>{const t=h(e);return g({[e]:void 0}),t})("sync")||void 0,l=!1,u=!0,p=e(r,((...e)=>{const t=H.findIndex(e=>m()===e);if(t<0)throw new Error("Invalid view");return e.map(([e,n])=>e[t]&&n).filter(e=>e)})([[u,u,l],B({key:i})],[[u,u,u],D(r)],[[u,u,l],s],[[u,u,u],t],[[u,l,l],n()],[[u,u,u],a],[[u,u,u],Y({history:!1})],[[u,u,l],d()],[[u,u,l],c],[[u,l,l],V],[[u,u,l],z()],[[u,l,l],v()],[[u,u,u],o]));window.addEventListener("beforeunload",()=>g({sync:p.syncKey})),window.addEventListener("unload",()=>p.destroy())}()}();
</script></body></html>